> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [juejin.cn](https://juejin.cn/post/7312640704404111387)

计算机中的时间
-------

看完这篇文章相信你会对计算机中的时间有更系统全面的认识。

我经常自嘲，自己写的程序运行不超过 3 年，因为大部分项目方就早早跑路了。大多数项目上线后，你跟这个项目就再无瓜葛，关于时间你只需要保证时区正确就不会有太大问题，哈哈。 但是今天我想认真对待时间这个问题，作为一个库作者或基础软件作者，就需要考虑下游项目万一因为你处理时间不当而造成困扰，影响范围就比较广了。

计算机中与时间有关的关键词：时间类型、时间戳（timestamp）、定时器（例如 js 中 setInterval()）、时间计算、时间段、超时（setTimeout()）、时间片、GMT UTC Unix 时间戳 ISO8601 CST EST。

看到这些你可能会疑惑，为何一个时间竟然如此复杂!!

如果下面的问题你都能答上来，那这篇文章对你的帮助微乎其微，不如做些更有意义的事情。

*   常用的时间格式，他们都遵循哪些标准？
*   什么是 GMT？
*   什么是 UTC？
*   GMT UTC 和 ISO8601 有什么区别？
*   RFC5322 是什么？
*   RFC5322 采用的是 GMT 还是 UTC？
*   ISO8601 使用的是 UTC 还是 GMT？
*   在 ISO8601 中 Z 可以使用 + 00:00 表示吗？
*   UTC 什么时候校准？
*   CST 是东八区吗？
*   Z 是 ISO 8601 规定的吗, 为什么是 Z？
*   时区划分是哪个标准定义的？
*   为什么是 1970 年 1 月 1 日呢？
*   到了 2038 年时间戳溢出了怎么办？
*   计算机中时间的本质是一个 long 类型吗？
*   WEB 前后端用哪个格式传输好？
*   '2024-01-01T24:00:00' 等于 '2024-01-02T00:00:00' ??

如果看文章太累，也可以 B 站搜 程序饲养员 看《计算机中的时间》那期视频。

正文开始

1. 两种时间标准
---------

UTC 和 GMT 都是时间标准，定义事件的精度。它们只表示 零时区 的时间，本地时间则需要与 时区 或偏移 结合后表示。这两个标准之间差距通常不会超过一秒。

### UTC（协调世界时）

UTC，即协调世界时（Coordinated Universal Time），是一种基于原子钟的时间标准。它的校准是根据地球自转的变化而进行的，插入或删除闰秒的实际需求在短期内是难以预测的，因此这个决定通常是在需要校准的时候发布。 闰秒通常由国际电信联盟（ITU） 和国际度量衡局（BIPM） 等组织进行发布。由国际原子时（International Atomic Time，TAI） 通过闰秒 的调整来保持与地球自转的同步。

### GMT（格林尼治标准时间）

以英国伦敦附近的格林尼治天文台（0 度经线，本初子午线）的时间为基准。使用地球自转的平均速度来测量时间，是一种相对于太阳的平均时刻。尽管 GMT 仍然被广泛使用，但现代科学和国际标准更倾向于使用 UTC。

2. 两种显示标准
---------

上面我们讨论的时间标准主要保证的是时间的精度，时间显示标准指的是时间的字符串表示格式。我们熟知的有 RFC 5322 和 ISO 8601。

### RFC 5322 电子邮件消息格式的规范

RFC 5322 的最新版本是在 2008 年 10 月在 IETF 发布的，你阅读时可能有了更新的版本。

> RFC 5322 是一份由 Internet Engineering Task Force (IETF) 制定的标准，定义了 Internet 上的电子邮件消息的格式规范。该标准于 2008 年发布，是对之前的 RFC 2822 的更新和扩展。虽然 RFC 5322 主要关注电子邮件消息的格式，但其中的某些规范，比如日期时间格式，也被其他领域采纳，例如在 HTTP 协议中用作日期头部（Date Header）的表示。

格式通常如下:

```
Thu, 14 Dec 2023 05:36:56 GMT


```

时区部分为了可读可以如下表示：

```
Thu, 14 Dec 2023 05:36:56 CST
Thu, 14 Dec 2023 05:36:56 +0800
Thu, 14 Dec 2023 05:36:56 +0000
Thu, 14 Dec 2023 05:36:56 Z


```

但并不是所有程序都兼容这种时区格式，通常程序会忽略时区，在写程序时要做好测试。标准没有定义毫秒数如何显示。

需要注意的是，有时候我们会见到这种格式 Tue Jan 19 2038 11:14:07 GMT+0800 (中国标准时间)，这是 js 日期对象转字符串的格式，它与标准无关，千万不要混淆了。

### ISO 8601

ISO 8601 最新版本是 ISO 8601:2019，发布日期为 2019 年 11 月 15 日，你阅读时可能有了更新的版本。

下面列举一些格式示例：

```
2004-05-03T17:30:08+08:00
2004-05-03T17:30:08+00:00
2004-05-03T17:30:08Z
2004-05-03T17:30:08.000+08:00


```

标准并没有定义小数位数，保险起见秒后面一般是 3 位小数用来表示毫秒数。 字母 "Z" 是 "zero"（零）的缩写，因此它被用来表示零时区，也可以使用 + 00:00，但 Z 更直观且简洁。

1.  本标准提供两种方法来表示时间：一种是只有数字的基础格式；第二种是添加了分隔符的扩展格式，更易读。扩展格式使用连字符 “-” 来分隔日期，使用冒号 “:” 来分隔时间。比如 2009 年 1 月 6 日在扩展格式中可以写成 "2009-01-06"，在基本格式中可以简单地写成 "20090106" 而不会产生歧义。 若要表示前 1 年之前或 9999 年之后的年份，标准也允许有共识的双方扩展表达方式。双方应事先规定增加的位数，并且年份前必须有正号 “+” 或负号 “-” 而不使用“。依据标准，若年份带符号，则前 1 年为 "+0000"，前 2 年为 "-0001"，依此类推。
2.  午夜，一日的开始：完全表示为 000000 或 00:00:00；仅有小时和分表示为 0000 或 00:00
3.  午夜，一日的终止：完全表示为 240000 或 24:00:00；仅有小时和分表示为 2400 或 24:00
4.  如果时间在零时区，并恰好与 UTC 相同，那么在时间最后加一个大写字母 Z。Z 是相对协调世界时时间 0 偏移的代号。 如下午 2 点 30 分 5 秒表示为 14:30:05Z 或 143005Z；只表示小时和分，为 1430Z 或 14:30Z；只表示小时，则为 14Z 或 14Z。
5.  其它时区用实际时间加时差表示，当时的 UTC+8 时间表示为 22:30:05+08:00 或 223005+0800，也可以简化成 223005+08。

日期与时间合并表示时，要在时间前面加一大写字母 T，如要表示东八区时间 2004 年 5 月 3 日下午 5 点 30 分 8 秒，可以写成 2004-05-03T17:30:08+08:00 或 20040503T173008+08。

在编写 API 时推荐使用 ISO 8601 标准接收参数或响应结果，并且做好时区测试，因为不同编程语言中实现可能有差异。

时区划分和偏移
-------

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d421cfbff8884377a50e4fa2dbbce092~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=720&h=388&s=285136&e=png&b=e6dfc5)

添加图片注释，不超过 140 字（可选）

全球被分为 24 个时区，每个时区对应一个小时的时间差。 时区划分由 IANA 维护和管理，其时区数据库被称为 TZ Database（或 Olson Database）。这个数据库包含了全球各个时区的信息，包括时区的名称、标识符、以及历史性的时区变更数据，例如夏令时的开始和结束时间等。在许多操作系统（如 Linux、Unix、macOS 等）和编程语言（如 Java、Python 等）中得到广泛应用。

TZ Database 具体见我整理的表格，是从 Postgresql 中导出的一份 Excel，关注公众号 "程序饲养员"，回复 "tz"

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8cd07bf423e54266abfdd05f4fc115d6~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=720&h=561&s=345492&e=png&b=f8f8f8)

添加图片注释，不超过 140 字（可选）

时区标识符采用 "洲名 / 城市名" 的命名规范，例如："America/New_York" 或 "Asia/Shanghai"。这种命名方式旨在更准确地反映时区的地理位置。时区的具体规定和管理可能因国家、地区、或国际组织而异。

有一些时区是按照半小时或 15 分钟的间隔进行偏移的，以适应地理和政治需求。在某些地区，特别是位于边界上的地区，也可能采用不同的时区规则。

EST，CST、GMT（另外一个含义是格林尼治标准时间）这些都是时区的缩写。

这种简写存在重复，如 CST 可能有多种不同的含义，China Standard Time（中国标准时间），它对应于 UTC+8，即东八区。Central Standard Time（中部标准时间） 在美国中部标准时间的缩写中也有用。中部标准时间对应于 UTC-6，即西六区。因此在某些软件配置时不要使用简称, 一定要使用全称，如”Asia/Shanghai“。

### 采用东八区的国家和地区有哪些

*   中国： 中国标准时间（China Standard Time，CST）是东八区的时区，对应于 UTC+8。
*   ~中国香港： 中国香港也采用东八区的时区，对应于 UTC+8。~
*   ~中国澳门： 澳门也在东八区，使用 UTC+8。~
*   ~中国台湾： 台湾同样在东八区，使用 UTC+8。~
*   新加坡： 新加坡位于东八区，使用 UTC+8。
*   马来西亚： 马来西亚的半岛部分和东马来西亚位于东八区，使用 UTC+8。
*   菲律宾： 菲律宾采用东八区的时区，对应于 UTC+8。

计算机系统中的时间 —— Unix 时间戳
---------------------

Unix 时间戳（Unix timestamp）定义为从 1970 年 01 月 01 日 00 时 00 分 00 秒 (UTC) 起至现在经过的总秒数（秒是毫秒、微妙、纳秒的总称）。

这个时间点通常被称为 "Epoch" 或 "Unix Epoch"。时间戳是一个整数，表示从 Epoch 开始经过的秒数。

一些关键概念：

1.  起始时间点： Unix 时间戳的起始时间是 1970 年 1 月 1 日 00:00:00 UTC。在这一刻，Unix 时间戳为 0。
    
2.  增量单位： Unix 时间戳以秒为单位递增。每过一秒，时间戳的值增加 1。
    
3.  正负值： 时间戳可以是正值或负值。正值表示从 Epoch 开始经过的秒数，而负值表示 Epoch 之前的秒数。
    
4.  精度： 通常情况下，Unix 时间戳以整数形式表示秒数。有时也会使用浮点数表示秒的小数部分，以提供更精细的时间分辨率。精确到秒是 10 位；有些编程语言精确到毫秒是 13 位，被称为毫秒时间戳。
    

### 为什么是 1970 年 1 月 1 日？

这个选择主要是出于历史和技术的考虑。

Unix 操作系统的设计者之一，肯 · 汤普森（Ken Thompson）和丹尼斯 · 里奇（Dennis Ritchie）在开发 Unix 操作系统时，需要选择一个固定的起始点来表示时间。1970-01-01 00:00:00 UTC 被选为起始时间。这个设计的简洁性和通用性使得 Unix 时间戳成为计算机系统中广泛使用的标准方式来表示和处理时间。

### 时间戳为什么只能表示到 2038 年 01 月 19 日 03 时 14 分 07 秒？

在许多系统中，结构体 time_t 被定义为 long，具体实现取决于编译器和操作系统的架构。例如，在 32 位系统上，time_t 可能是 32 位的 long，而在 64 位系统上，它可能是 64 位的 long。 32 位有符号 long 类型，实际表示整数只有 31 位，最大能表示十进制 2147483647（01111111 11111111 11111111 11111111）。

```
> new Date(2147483647000)
< Tue Jan 19 2038 11:14:07 GMT+0800 (中国标准时间)


```

实际上到 2038 年 01 月 19 日 03 时 14 分 07 秒，便会到达最大时间，过了这个时间点，所有 32 位操作系统时间便会变为 10000000 00000000 00000000 00000000。因具体实现不同，有可能会是 1901 年 12 月 13 日 20 时 45 分 52 秒，这样便会出现时间回归的现象，很多软件便会运行异常了。

至于时间回归的现象相信随着 64 为操作系统的产生逐渐得到解决，因为用 64 位操作系统可以表示到 292,277,026,596 年 12 月 4 日 15 时 30 分 08 秒。

另外，考虑时区因素，北京时间的时间戳的起始时间是 1970-01-01T08:00:00+08:00。

好了，关于计算机中的时间就说完了，有疑问评论区相见 或 关注 程序饲养员 公号。

*   [zh.wikipedia.org/wiki/ISO_86…](https://link.juejin.cn?target=https%3A%2F%2Fzh.wikipedia.org%2Fwiki%2FISO_8601 "https://zh.wikipedia.org/wiki/ISO_8601")
*   [en.wikipedia.org/wiki/Coordi…](https://link.juejin.cn?target=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FCoordinated_Universal_Time "https://en.wikipedia.org/wiki/Coordinated_Universal_Time")
*   [blog.csdn.net/taolong1/ar…](https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Ftaolong1%2Farticle%2Fdetails%2F20742613 "https://blog.csdn.net/taolong1/article/details/20742613")